<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <title>Wild Rift ‚Äì Stats by ERjanKG</title>
  <style>
    /* –ü–ï–†–ï–ú–ï–ù–ù–´–ï iOS / GOOGLE */
    :root { 
      --p: #7b5cff; 
      --bg: #0b0f17; 
      --card: #1c222d; 
      --header-bg: #252c3a;
      --brd: rgba(255, 255, 255, 0.08);
      --energy: #ffcc00;
      --radius: 18px;
      --font: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, sans-serif;
    }

    body { 
      margin: 0; 
      background: var(--bg); 
      color: #f1f3f4; 
      font-family: var(--font); 
      -webkit-font-smoothing: antialiased;
    }

    .wrap { max-width: 1200px; margin: 0 auto; padding: 20px; }

    /* –í–ï–†–•–ù–Ø–Ø –ü–ê–ù–ï–õ–¨ */
    .header-top { 
      display: flex; justify-content: space-between; align-items: center; 
      margin-bottom: 24px; padding: 0 5px;
    }
    .nick { font-size: 28px; font-weight: 700; letter-spacing: -0.8px; }
    
    @keyframes spin { 0% { transform: rotate(0deg); } 15% { transform: rotate(360deg); } 100% { transform: rotate(360deg); } }
    .twitch-link { 
      display: flex; align-items: center; gap: 10px; text-decoration: none; 
      color: #fff; font-weight: 600; background: #9146ff; 
      padding: 8px 16px; border-radius: 50px; font-size: 14px;
      box-shadow: 0 4px 12px rgba(145, 70, 255, 0.3);
    }
    .twitch-link img { width: 20px; animation: spin 5s infinite ease-in-out; }

    /* –ö–ê–†–¢–û–ß–ö–ê –ü–û–î–î–ï–†–ñ–ö–ò */
    .support-box { 
      background: var(--card); border: 1px solid var(--brd); 
      padding: 24px; border-radius: var(--radius); margin-bottom: 24px; 
      box-shadow: 0 8px 24px rgba(0,0,0,0.2);
    }
    .donateBtn { 
      display: block; text-align: center; padding: 14px; margin-top: 16px;
      background: #fff; color: #000; text-decoration: none; 
      border-radius: 14px; font-weight: 700; font-size: 15px;
      transition: transform 0.2s;
    }
    .donateBtn:active { transform: scale(0.98); }

    /* –ü–û–õ–ó–£–ù–û–ö iOS */
    .levelBar { 
      background: var(--card); border: 1px solid var(--brd); 
      padding: 24px; border-radius: var(--radius); margin-bottom: 24px;
    }
    .range-wrap { margin: 20px 0 10px; }
    input[type="range"] { 
      width: 100%; height: 6px; border-radius: 10px; background: #3c4043;
      appearance: none; outline: none; 
    }
    input[type="range"]::-webkit-slider-thumb { 
      appearance: none; width: 24px; height: 24px; background: #fff; 
      border-radius: 50%; cursor: pointer; box-shadow: 0 2px 6px rgba(0,0,0,0.4);
    }
    .range-labels { display: flex; justify-content: space-between; margin-top: 12px; color: #9aa0a6; font-size: 11px; font-weight: 500; }

    /* –¢–ê–ë–õ–ò–¶–ê */
    .tableWrap { 
      border: 1px solid var(--brd); border-radius: var(--radius); 
      background: var(--card); overflow: hidden; box-shadow: 0 12px 32px rgba(0,0,0,0.3);
    }
    table { width: 100%; border-collapse: collapse; table-layout: fixed; }
    th { 
      background: var(--header-bg); padding: 14px 5px; font-size: 11px; 
      font-weight: 700; text-transform: uppercase; letter-spacing: 0.8px; color: #9aa0a6;
      position: sticky; top: 0; z-index: 10; border-bottom: 1px solid var(--brd);
    }
    td { padding: 14px 4px; text-align: center; border-bottom: 1px solid var(--brd); border-right: 1px solid var(--brd); font-size: 14px; }
    tr:nth-child(even) { background: rgba(255,255,255,0.02); }

    /* –°–¢–û–õ–ë–ï–¶ –ß–ï–ú–ü–ò–û–ù–ê */
    .champ-col { display: flex; align-items: center; justify-content: flex-start; gap: 12px; padding-left: 12px; }
    .btn-x { 
      color: #ff5252; cursor: pointer; border: none; background: rgba(255,82,82,0.1); 
      width: 20px; height: 20px; border-radius: 6px; font-size: 12px;
      display: flex; align-items: center; justify-content: center;
    }
    .champ-name { cursor: pointer; font-weight: 500; transition: color 0.2s; }
    .is-pinned { color: var(--p); font-weight: 700; text-decoration: underline; text-underline-offset: 4px; }

    .clear-btn { 
      background: #3c4043; color: #fff; border: none; padding: 4px 10px; 
      border-radius: 8px; font-size: 10px; cursor: pointer; margin-left: 8px;
    }

    /* TIERS (GOOGLE STYLE - –ú–Ø–ì–ö–ò–ï) */
    .tier-top1 { background: rgba(234, 67, 53, 0.45) !important; font-weight: 700; }
    .tier-top10 { background: rgba(234, 67, 53, 0.25) !important; }
    .tier-mid { background: rgba(251, 188, 4, 0.25) !important; color: #ffca28; }
    .tier-low { background: rgba(52, 168, 83, 0.25) !important; color: #81c995; }
    .energy { color: var(--energy); font-weight: 800; font-size: 10px; }
    .mana-zero { color: #5f6368; }

    /* –ú–û–î–ê–õ–ö–ê (iOS GLASS) */
    .modal { position: fixed; inset: 0; z-index: 1000; display: flex; align-items: center; justify-content: center; padding: 15px; }
    .hidden { display: none; }
    .modal-backdrop { position: absolute; inset: 0; background: rgba(0,0,0,0.6); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); }
    .modal-card { 
      position: relative; width: 100%; max-width: 850px; height: 80vh; 
      background: rgba(30, 37, 50, 0.95); border-radius: 32px; border: 1px solid rgba(255,255,255,0.1);
      display: flex; flex-direction: column; overflow: hidden; box-shadow: 0 25px 50px rgba(0,0,0,0.5);
    }
    .modal-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; padding: 24px; overflow-y: auto; }
    .role-col { display: flex; flex-direction: column; gap: 8px; }
    .role-head { 
      cursor: pointer; padding: 12px; text-align: center; background: rgba(255,255,255,0.03); 
      border-radius: 18px; margin-bottom: 8px; transition: 0.2s;
    }
    .role-head:hover { background: rgba(123, 92, 255, 0.2); }
    .role-head img { width: 28px; height: 28px; }
    
    .champ-btn { 
      width: 100%; padding: 10px 4px; border-radius: 12px; border: 1px solid transparent; 
      background: rgba(255,255,255,0.05); color: #9aa0a6; font-size: 12px; cursor: pointer; transition: 0.2s;
    }
    .champ-btn.selected { background: var(--p); color: #fff; font-weight: 600; box-shadow: 0 4px 12px rgba(123, 92, 255, 0.3); }
    
    .close-corner { 
      position: absolute; top: 18px; right: 18px; background: #303134; color: #fff; 
      border: none; width: 32px; height: 32px; border-radius: 50%; cursor: pointer; z-index: 10; font-size: 16px;
    }

    @media (max-width: 768px) {
      .wrap { padding: 12px; }
      .header-top { margin-bottom: 16px; }
      .nick { font-size: 22px; }
      .modal-grid { grid-template-columns: repeat(5, 1fr); gap: 4px; padding: 10px; }
      td, th { font-size: 12px; padding: 10px 2px; }
      .champ-name { font-size: 11px; }
    }
  </style>
</head>
<body>

<div class="wrap">
  <div class="header-top">
    <div class="nick">ERjanKG</div>
    <a href="https://www.twitch.tv/ERjanKG" class="twitch-link" target="_blank">
      <img src="https://upload.wikimedia.org/wikipedia/commons/d/d3/Twitch_Glitch_Logo_Purple.svg" alt="T">
      <span>Twitch</span>
    </a>
  </div>

  <div class="support-box">
    <div style="font-size: 14px; opacity: 0.7; font-weight: 500;">–°–∞–π—Ç –±–µ—Å–ø–ª–∞—Ç–µ–Ω. –ë—É–¥—É –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω –∑–∞ –ø–æ–¥–¥–µ—Ä–∂–∫—É –ø—Ä–æ–µ–∫—Ç–∞!</div>
    <a class="donateBtn" href="https://www.donationalerts.com/r/erjankg" target="_blank">üíú –ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–æ–µ–∫—Ç</a>
  </div>

  <div class="levelBar">
    <div style="font-weight:600; font-size: 15px; color: #9aa0a6;">–£—Ä–æ–≤–µ–Ω—å: <span id="levelVal" style="color:#fff">10</span></div>
    <div class="range-wrap">
      <input id="level" type="range" min="1" max="15" value="10">
      <div class="range-labels">
        <span>1</span><span>2</span><span>3</span><span>4</span><span>5</span><span>6</span><span>7</span><span>8</span><span>9</span><span>10</span><span>11</span><span>12</span><span>13</span><span>14</span><span>15</span>
      </div>
    </div>
  </div>

  <div class="tableWrap">
    <table>
      <thead>
        <tr>
          <th style="width:38%" onclick="openChampModal()">
            <div style="display:flex; align-items:center; justify-content:center;">
              Champion ‚öôÔ∏è <button class="clear-btn" onclick="event.stopPropagation(); clearExceptPinned();">Clear</button>
            </div>
          </th>
          <th>AD</th><th>HP</th><th>Mana</th><th>Arm</th><th>MR</th>
        </tr>
      </thead>
      <tbody id="tbody"></tbody>
    </table>
  </div>
</div>

<div id="champModal" class="modal hidden">
  <div class="modal-backdrop" onclick="closeChampModal()"></div>
  <div class="modal-card">
    <button class="close-corner" onclick="closeChampModal()">‚úï</button>
    <div style="padding:24px 24px 10px; border-bottom:1px solid var(--brd)">
      <div style="font-size:20px; font-weight:700; letter-spacing:-0.5px;">–í—ã–±–æ—Ä —á–µ–º–ø–∏–æ–Ω–æ–≤</div>
      <div style="font-size:13px; color:#9aa0a6; margin-top:4px;">–ö–ª–∏–∫–Ω–∏ –Ω–∞ –∏–∫–æ–Ω–∫—É —Ä–æ–ª–∏, —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å –≤—Å–µ—Ö</div>
    </div>
    <div id="champModalGrid" class="modal-grid"></div>
  </div>
</div>

<script>
  const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQnqVwUluQiuho1Wj6A3tZRvDJsLlyAZYmg0soWy4EJ_Un00P8e3Y2EAo3Iv6KvMm5HPwce_0AnzPfb/pub?gid=0&single=true&output=tsv";
  const COLS = ["ad", "hp", "mana", "armor", "mr"];
  const roles = [
    { key: "Top", icon: "assets/roles/top.png" },
    { key: "Jungle", icon: "assets/roles/jungle.png" },
    { key: "Mid", icon: "assets/roles/mid.png" },
    { key: "ADC", icon: "assets/roles/adc.png" },
    { key: "Support", icon: "assets/roles/support.png" }
  ];

  let raw = [], selected = new Set(), pinned = new Set(), level = 10;

  async function init() {
    try {
      const res = await fetch(CSV_URL);
      const text = await res.text();
      const lines = text.trim().split('\n').map(l => l.split('\t'));
      const h = lines[0].map(s => s.trim());
      raw = lines.slice(1).map(row => {
        let o = {}; h.forEach((n, i) => o[n] = row[i]?.trim());
        return {
          name: o["Champion"], ad_b: +o["AD_Base"], ad_g: +o["AD_Growth"],
          hp_b: +o["HP_Base"], hp_g: +o["HP_Growth"], mn_b: +o["Mana_Base"], mn_g: +o["Mana_Growth"],
          ar_b: +o["Armor_Base"], ar_g: +o["Armor_Growth"], mr_b: +o["MR_Base"], mr_g: +o["MR_Growth"],
          res: o["Resource"] || "Mana",
          is: { Top: +o["Is_Top"]===1, Jungle: +o["Is_Jungle"]===1, Mid: +o["Is_Mid"]===1, ADC: +o["Is_Adc"]===1, Support: +o["Is_Support"]===1 }
        };
      }).filter(r => r.name);
      selected = new Set(raw.map(r => r.name));
      renderTable();
    } catch(e) { console.error("CSV Load Error"); }
  }

  function renderTable() {
    const tbody = document.getElementById("tbody");
    const data = raw.filter(r => selected.has(r.name)).map(r => {
      let calc = (b, g) => b + (level - 1) * g;
      return { 
        name: r.name, res: r.res, 
        ad: calc(r.ad_b, r.ad_g), hp: calc(r.hp_b, r.hp_g), mana: calc(r.mn_b, r.mn_g), armor: calc(r.ar_b, r.ar_g), mr: calc(r.mr_b, r.mr_g), 
        g: { ad: r.ad_g, hp: r.hp_g, mana: r.mn_g, armor: r.ar_g, mr: r.mr_g } 
      };
    }).sort((a,b) => b.ad - a.ad);

    const thres = {};
    COLS.forEach(k => {
      let v = data.map(d => d[k]).sort((a,b) => a-b);
      thres[k] = { t1: v[Math.floor(v.length*0.98)], t10: v[Math.floor(v.length*0.90)], l10: v[Math.floor(v.length*0.15)] };
    });

    tbody.innerHTML = "";
    data.forEach(r => {
      const tr = document.createElement("tr");
      const isP = pinned.has(r.name);
      tr.innerHTML = `<td><div class="champ-col">
        <button class="btn-x" onclick="selected.delete('${r.name}'); renderTable();">√ó</button>
        <span class="champ-name ${isP?'is-pinned':''}" onclick="togglePin('${r.name}')">${r.name}</span>
      </div></td>`;
      
      COLS.forEach(k => {
        const td = document.createElement("td");
        const val = r[k];
        if(k === "mana" && r.res === "Energy") { td.className = "energy"; td.innerText = "NRG"; }
        else if(k === "mana" && val === 0) { td.className = "mana-zero"; td.innerText = "0"; }
        else {
          td.innerText = Math.round(val);
          if(val >= thres[k].t1) td.classList.add("tier-top1");
          else if(val >= thres[k].t10) td.classList.add("tier-top10");
          else if(val <= thres[k].l10) td.classList.add("tier-low");
          else td.classList.add("tier-mid");
        }
        tr.appendChild(td);
      });
      tbody.appendChild(tr);
    });
  }

  function togglePin(name) { pinned.has(name) ? pinned.delete(name) : pinned.add(name); renderTable(); }
  function clearExceptPinned() { selected = new Set([...pinned]); renderTable(); }
  function openChampModal() { document.getElementById("champModal").classList.remove("hidden"); renderChampModal(); }
  function closeChampModal() { document.getElementById("champModal").classList.add("hidden"); }

  function renderChampModal() {
    const grid = document.getElementById("champModalGrid"); grid.innerHTML = "";
    roles.forEach(role => {
      const col = document.createElement("div"); col.className = "role-col";
      col.innerHTML = `<div class="role-head" onclick="toggleRole('${role.key}')"><img src="${role.icon}"></div>`;
      raw.filter(r => r.is[role.key]).sort((a,b)=>a.name.localeCompare(b.name)).forEach(r => {
        const btn = document.createElement("button");
        btn.className = "champ-btn" + (selected.has(r.name)?" selected":"");
        btn.innerText = r.name;
        btn.onclick = () => { 
          selected.has(r.name) ? selected.delete(r.name) : selected.add(r.name); 
          renderChampModal(); renderTable(); 
        };
        col.appendChild(btn);
      });
      grid.appendChild(col);
    });
  }

  function toggleRole(key) {
    const names = raw.filter(r => r.is[key]).map(r => r.name);
    const all = names.every(n => selected.has(n));
    names.forEach(n => all ? selected.delete(n) : selected.add(n));
    renderChampModal(); renderTable();
  }

  document.getElementById("level").oninput = (e) => {
    level = +e.target.value; document.getElementById("levelVal").innerText = level; renderTable();
  };

  init();
</script>
</body>
</html>